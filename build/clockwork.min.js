/*! clockwork 2018-10-23 */
"use strict";angular.module("ng-clockwork",["ngResource","ngCookies","ng-clockwork.controllers","ng-clockwork.config","ng-clockwork.directives","ng-clockwork.filters","ng-clockwork.services","ng-clockwork.objectLoader","ng-clockwork.editEvents","ng-clockwork.editActions","ng-clockwork.sceneFactory","ng-clockwork.utilFactory","ng-clockwork.templateFactory","ui.bootstrap"]),angular.module("ng-clockwork.config",[]).constant("constants",{EIGHTH_PI:Math.PI/8,TWELFTH_PI:Math.PI/12,TWO_PI:2*Math.PI,FLOOR_HEIGHT:.2,GRID_SPACING:1,OBJECT_SCALE_CHANGE:.1,OBJECT_OFFSET_CHANGE:.1,OBJECT_REPEAT_CHANGE:1,OBJECT_MOVE_SPEED:.5,OBJECT_ROTATE_RADIANS:Math.PI/12,OBJECT_ROTATE_DEGREES:15,USER_MOVE_SPEED:.05,USER_TURN_SPEED:.05,USER_HEIGHT:.1}).constant("clockworkConfig",{name:"Development",version:function(){var a=new Date-new Date("3/24/2015"),b=Math.abs(a)/6048e5,c=parseInt(10*b)/10;return"0.0."+c}(),restUrl:"./json/",enableLogging:!1}).constant("menuBar",{menuItems:[[{name:"gridButton",active:!1,onclick:"toggleGrid()",text:"Grid",title:"Show/Hide Grid"},{name:"editButton",active:!0,onclick:"toggleEditingInterface($event)",text:"Edit",title:"Show/Hide Edit Panel"},{name:"saveButton",active:!0,onclick:"saveScene()",text:"Save",title:"Save"}]]}),angular.module("ng-clockwork.controllers",[]).controller("ClockworkController",["$scope","$rootScope","threeScene","editEvents",function(a,b,c,d){b.pageTitle="ngClockwork",a.selectedObject=null,a.speedStatus="",a.handleKeydown=function(a){d.keyDown(a,d.actions)},a.handleKeyup=function(a){d.keyUp(a,d.actions)},a.saveScene=function(){a.$broadcast("saveScene")},a.toggleGrid=function(){console.log("toggleGrid")},a.toggleEditingInterface=function(a){angular.element("#editButton").toggleClass("on");var b=angular.element("#objectEditPanel");b.hasClass("open")?b.animate({right:"-=300"},250,function(){b.removeClass("open").addClass("closed")}):b.animate({right:"+=300"},250,function(){b.removeClass("closed").addClass("open")})},a.handleWindowResize=function(){c.ready&&(c.camera.aspect=window.innerWidth/window.innerHeight,c.camera.updateProjectionMatrix(),c.renderer.setSize(window.innerWidth,window.innerHeight))}}]).controller("SceneController",["$scope","dataService","$element","editEvents","objectEditor","objectStore","threeScene",function(a,b,c,d,e,f,g){a.handleMousedown=function(b){a.intersects=f.objectSelect(b,g)},a.$on("saveScene",function(a){d.actions.fileSave=!0}),g.init(c),b.loadSceneJSON("./json/scene1.json").then(function(b){200!==b.status?alert("File load error.  File could not be found. Error: "+b.status):(g.sceneData=b.data,g.camera=f.loadScene(g),g.ready=!0,a.animate())}),a.animate=function(){a.stats.update(),e.update(g,d.actions),f.update(g,d.actions),d.actions.fileSave&&(d.actions.fileSave=!1,b.saveScene(g)),requestAnimationFrame(a.animate),a.render()},a.render=function(){g.renderer.render(g.scene,g.camera)}}]).controller("ObjectEditController",["$scope","threeScene","dataService","constants",function(a,b,c,d){a.textureList=[],a.modelList=[],a.modelNames=[],a["const"]=d,a.selected=b.selectedObject,a.hasMap=!1,a.selectedType="",a.defaultTexture=null,a.testTexture="",a.activeTab="MOVEMENT",a.toggleVis=function(b){a.activeTab=b},a.cancelTexture=function(){if(a.hasMap){var b=a.selected.userData.template.texture.path,c=a.selected.material.map,d=c.repeat.x,e=c.repeat.y,f=new THREE.TextureLoader;a.selected.material.map=f.load(b),a.selected.material.map.wrapS=a.selected.material.map.wrapT=THREE.RepeatWrapping,a.selected.material.map.repeat.set(d,e),a.selected.material.needsUpdate=!0,a.testTexture=""}else a.selected.material.map=null,a.selected.material.needsUpdate=!0,a.testTexture=""},a.applyTexture=function(b){if("Mesh"===a.selected.type){var c,d,e;a.selected.material.map?(c=a.selected.material.map,d=c.repeat.x,e=c.repeat.y):(d=1,e=1);var f=new THREE.TextureLoader;a.selected.material.map=f.load(b),a.selected.material.map.wrapS=a.selected.material.map.wrapT=THREE.RepeatWrapping,a.selected.material.map.repeat.set(d,e),a.selected.material.needsUpdate=!0,a.testTexture=b}},a.confirmTexture=function(b){var c=a.selected.userData.template;"texture"in c?c.texture.path=b:c.texture={anisotropy:16,path:b,repeat:{height:1,width:1}},a.testTexture=""},c.getAvailableTextures().then(function(b){200!==b.status?alert("File load error.  Directory or files could not be found. Error: "+b.status):a.textureList=b.data.split(",")}),c.getAvailableModels().then(function(b){200!==b.status?alert("File load error.  Directory or files could not be found. Error: "+b.status):a.modelList=b.data}),a.showRemoveTexture=function(b){return a.testTexture===b&&"Group"!==a.selectedType},a.showConfirmTexture=function(b){return a.testTexture===b&&"Group"!==a.selectedType},a.applyIsDisabled=function(){return!a.selected||"Group"===a.selectedType},a.enableTextureChange=function(){a.selected=b.selectedObject,a.hasMap=!1,a.defaultTexture=null,a.selectedType="",a.testTexture="",a.selected&&(a.selectedType=a.selected.type,a.selected.material&&(a.selected.material.map?(a.hasMap=!0,a.defaultTexture=a.selected.material.map.sourceFile):(a.hasMap=!1,a.defaultTexture=null)))},a.$watch(function(){return b.selectedObject},function(){a.enableTextureChange()})}]).controller("MeshEditScaleController",["$scope","constants",function(a,b){a.dec=function(a){return(1e3*a-1e3*b.OBJECT_SCALE_CHANGE)/1e3},a.inc=function(a){return(1e3*a+1e3*b.OBJECT_SCALE_CHANGE)/1e3},a.incScaleX=function(){a.selected.scale.x=a.inc(a.selected.scale.x)},a.decScaleX=function(){a.selected.scale.x=a.dec(a.selected.scale.x)},a.incScaleY=function(){a.selected.scale.y=a.inc(a.selected.scale.y)},a.decScaleY=function(){a.selected.scale.y=a.dec(a.selected.scale.y)},a.incScaleZ=function(){a.selected.scale.z=a.inc(a.selected.scale.z)},a.decScaleZ=function(){a.selected.scale.z=a.dec(a.selected.scale.z)}}]).controller("MeshEditPositionController",["$scope","constants",function(a,b){a.dec=function(a){return(1e3*a-1e3*b.OBJECT_MOVE_SPEED)/1e3},a.inc=function(a){return(1e3*a+1e3*b.OBJECT_MOVE_SPEED)/1e3},a.incPosX=function(){a.selected.position.x=a.inc(a.selected.position.x)},a.decPosX=function(){a.selected.position.x=a.dec(a.selected.position.x)},a.incPosY=function(){a.selected.position.y=a.inc(a.selected.position.y)},a.decPosY=function(){a.selected.position.y=a.dec(a.selected.position.y)},a.incPosZ=function(){a.selected.position.z=a.inc(a.selected.position.z)},a.decPosZ=function(){a.selected.position.z=a.dec(a.selected.position.z)}}]).controller("MeshEditRotationController",["$scope","constants","degreeSync",function(a,b,c){a.degX=0,a.degY=0,a.degZ=0,a.updateRotation=function(){c.updateRotation(a.selected)},a.incDegX=function(){a.selected.degrees.x=c.safeChange(a.selected.degrees.x,b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)},a.decDegX=function(){a.selected.degrees.x=c.safeChange(a.selected.degrees.x,-b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)},a.incDegY=function(){a.selected.degrees.y=c.safeChange(a.selected.degrees.y,b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)},a.decDegY=function(){a.selected.degrees.y=c.safeChange(a.selected.degrees.y,-b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)},a.incDegZ=function(){a.selected.degrees.z=c.safeChange(a.selected.degrees.z,b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)},a.decDegZ=function(){a.selected.degrees.z=c.safeChange(a.selected.degrees.z,-b.OBJECT_ROTATE_DEGREES),c.updateRotation(a.selected)}}]).controller("MaterialEditController",["$scope","threeScene",function(a,b){a.onlyOneOpen=!0,a.openTop=!0,a.selected=null,a.material=null,a.colors={color:"#ffffff",emissive:"#ffffff",specular:"#ffffff"},a.shadings=[{value:0,label:"NoShading"},{value:1,label:"FlatShading"},{value:2,label:"SmoothShading"}],a.sidings=[{value:0,label:"FrontSide"},{value:1,label:"BackSide"},{value:2,label:"DoubleSide"}],a.vertexColors=[{value:0,label:"NoColors"},{value:1,label:"FaceColors"},{value:2,label:"VertexColors"}],a.boolToStr=function(a){return a?"true":"false"},a.invertColor=function(a){var b=a;return b=b.substring(1),b=parseInt(b,16),b=16777215^b,b=b.toString(16),b=("000000"+b).slice(-6),b="#"+b},a.getHexColors=function(){a.colors.color="#"+a.material.color.getHexString(),a.colors.emissive="#"+a.material.emissive.getHexString(),a.colors.specular="#"+a.material.specular.getHexString()},a.clearHexColors=function(){a.colors.color="#ffffff",a.colors.emissive="#ffffff",a.colors.specular="#ffffff"},a.getRandomHexColor=function(){return"#"+(16777215*Math.random()<<0).toString(16)},a.setColor=function(){a.material.color.setStyle(a.colors.color)},a.setEmissive=function(){a.material.emissive.setStyle(a.colors.emissive)},a.setSpecular=function(){a.material.specular.setStyle(a.colors.emissive)},a.$watch(function(){return b.selectedObject},function(){b.selectedObject?"Group"!==b.selectedObject.type&&(a.selected=b.selectedObject,a.material=b.selectedObject.material,a.getHexColors()):(a.selected=null,a.material=null,a.clearHexColors())})}]).controller("MeshEditTextureOffsetController",["$scope","constants",function(a,b){a.dec=function(a){return(1e3*a-1e3*b.OBJECT_OFFSET_CHANGE)/1e3},a.inc=function(a){return(1e3*a+1e3*b.OBJECT_OFFSET_CHANGE)/1e3},a.incOffsetX=function(){a.selected.material.map.offset.x=a.inc(a.selected.material.map.offset.x),a.selected.material.map.needsUpdate=!0},a.decOffsetX=function(){a.selected.material.map.offset.x=a.dec(a.selected.material.map.offset.x),a.selected.material.map.needsUpdate=!0},a.incOffsetY=function(){a.selected.material.map.offset.y=a.inc(a.selected.material.map.offset.y),a.selected.material.map.needsUpdate=!0},a.decOffsetY=function(){a.selected.material.map.offset.y=a.dec(a.selected.material.map.offset.y),a.selected.material.map.needsUpdate=!0}}]).controller("MeshEditTextureRepeatController",["$scope","constants",function(a,b){a.dec=function(a){return(1e3*a-1e3*b.OBJECT_REPEAT_CHANGE)/1e3},a.inc=function(a){return(1e3*a+1e3*b.OBJECT_REPEAT_CHANGE)/1e3},a.updateRepeat=function(){var b=a.selected.material.map;b.wrapS=b.wrapT=THREE.RepeatWrapping,b.repeat.set(b.repeat.x,b.repeat.y),b.needsUpdate=!0},a.incRepeatX=function(){a.selected.material.map.repeat.x=a.inc(a.selected.material.map.repeat.x),a.updateRepeat()},a.decRepeatX=function(){a.selected.material.map.repeat.x=a.dec(a.selected.material.map.repeat.x),a.updateRepeat()},a.incRepeatY=function(){a.selected.material.map.repeat.y=a.inc(a.selected.material.map.repeat.y),a.updateRepeat()},a.decRepeatY=function(){a.selected.material.map.repeat.y=a.dec(a.selected.material.map.repeat.y),a.updateRepeat()}}]).controller("MeshEditCreateController",["$scope","objectStore","templater",function(a,b,c){a.onlyOneOpen=!0,a.openTop=!0,a.selectedModel=a.modelList[0],a.displayChanged=function(b){a.selectedModel=b},a.createNewObject=function(d){switch(d){case"box":b.createNewObject(c.boxTemplate);break;case"circle":b.createNewObject(c.circleTemplate);break;case"cylinder":b.createNewObject(c.cylinderTemplate);break;case"dodecahedron":b.createNewObject(c.dodecahedronTemplate);break;case"icosahedron":b.createNewObject(c.icosahedronTemplate);break;case"octahedron":b.createNewObject(c.octahedronTemplate);break;case"plane":b.createNewObject(c.planeTemplate);break;case"ring":b.createNewObject(c.ringTemplate);break;case"sphere":b.createNewObject(c.sphereTemplate);break;case"tetrahedron":b.createNewObject(c.tetrahedronTemplate);break;case"text":b.createNewObject(c.textTemplate);break;case"collada":c.colladaTemplate.path=a.selectedModel.path,b.createNewObject(c.colladaTemplate)}},a.$watch(function(){return a.modelList},function(){a.selectedModel=a.modelList[0]})}]).controller("StatsController",["$scope","$element",function(a,b){a.stats=new Stats,b.append(a.stats.domElement)}]).controller("EditPanelAccordionController",["$scope",function(a){a.onlyOneOpen=!0,a.openTop=!0}]),angular.module("ng-clockwork.directives",[]).directive("threeStats",[function(){return{restrict:"AE",controller:"StatsController"}}]).directive("objectEditPanel",[function(){return{restrict:"AE",replace:"true",transclude:!1,templateUrl:"./partials/object-edit-panel.html",controller:"ObjectEditController"}}]).directive("panelToggleTab",[function(){return{restrict:"AE",replace:"true",scope:!0,transclude:!1,require:"^objectEditPanel",template:'<div class="transform_tab" ng-class="activeTab === name ? \'active\' : \'\'" ng-click="toggleVis(name);">{{name}}</div>',link:function(a,b,c){a.name=c.name}}}]).directive("clockworkTools",["menuBar","$compile",function(a,b){return{restrict:"AE",template:'<span class="title">ngClockwork</span>',link:function(c,d,e){for(var f=a.menuItems,g=angular.element('<div id="toolIcons"></div>'),h=0;h<f.length;h++){for(var i=f[h],j=0;j<i.length;j++){var k=i[j].active?"menuButton on":"menuButton",l='<span class="'+k+'" id="'+i[j].name+'"  ng-click="'+i[j].onclick+';">'+i[j].text+"</span>";g.append(l)}h!==f.length-1&&g.append('<span class="sectionBreak"></span>')}b(g)(c),d.append(g)}}}]).directive("appVersion",["clockworkConfig",function(a){return{restrict:"AE",replace:"true",template:'<span id="devInfo">ngClockwork: '+a.name+" version: "+a.version+"</span>"}}]).directive("resize",["$window",function(a){return function(b){var c=angular.element(a);b.getWindowDimensions=function(){return{h:a.innerHeight,w:a.innerWidth}},b.$watch(b.getWindowDimensions,function(a,c){b.handleWindowResize()},!0),c.bind("resize",function(){b.$apply()})}}]),angular.module("ng-clockwork.editActions",[]).factory("objectEditor",["constants","degreeSync",function(a,b){return{constants:a,update:function(a,c){var d=a.camera,e=a.selectedObject,f=this.constants,g=function(){e.degrees.x=0,e.degrees.y=0,e.degrees.z=0,b.updateRotation(e)},h=function(a,b){var c=parseInt(1e3*a),d=parseInt(1e3*b);return(c+d)/1e3},i=function(a){e.position.x=h(e.position.x,a)},j=function(a){e.position.y=h(e.position.y,a)},k=function(a){e.position.z=h(e.position.z,a)},l=function(a){e.degrees.x=b.safeChange(e.degrees.x,a),b.updateRotation(e)},m=function(a){e.degrees.y=b.safeChange(e.degrees.y,a),b.updateRotation(e)},n=function(a){e.degrees.z=b.safeChange(e.degrees.z,a),b.updateRotation(e)},o=function(){var a=f.OBJECT_MOVE_SPEED,b=d.rotation.y;b>f.TWO_PI?b%=f.TWO_PI:0>b&&(b=-(Math.abs(b)%f.TWO_PI),b+=f.TWO_PI),(c.moveObjectBack||c.moveObjectRight)&&(a=-a),(c.moveObjectForward||c.moveObjectBack)&&(b>1.75*Math.PI||b<.25*Math.PI?k(-a):b>.25*Math.PI&&b<.75*Math.PI?i(-a):b>.75*Math.PI&&b<1.25*Math.PI?k(a):b>1.25*Math.PI&&b<1.75*Math.PI&&i(a)),(c.moveObjectLeft||c.moveObjectRight)&&(b>1.75*Math.PI||b<.25*Math.PI?i(-a):b>.25*Math.PI&&b<.75*Math.PI?k(a):b>.75*Math.PI&&b<1.25*Math.PI?i(a):b>1.25*Math.PI&&b<1.75*Math.PI&&k(-a))};c.resetObjectRotations&&e&&(g(),c.resetObjectRotations=!1),c.rollXLess&&e&&(l(-f.OBJECT_ROTATE_DEGREES),c.rollXLess=!1),c.rollXMore&&e&&(l(f.OBJECT_ROTATE_DEGREES),c.rollXMore=!1),c.rollYLess&&e&&(m(-f.OBJECT_ROTATE_DEGREES),c.rollYLess=!1),c.rollYMore&&e&&(m(f.OBJECT_ROTATE_DEGREES),c.rollYMore=!1),c.rollZLess&&e&&(n(-f.OBJECT_ROTATE_DEGREES),c.rollZLess=!1),c.rollZMore&&e&&(n(f.OBJECT_ROTATE_DEGREES),c.rollZMore=!1),c.turnLeft&&(d.rotation.y+=f.USER_TURN_SPEED,d.degrees.y=d.rotation.y*(180/Math.PI)),c.turnRight&&(d.rotation.y-=f.USER_TURN_SPEED,d.degrees.y=d.rotation.y*(180/Math.PI)),c.moveDown&&(e?(j(-f.OBJECT_MOVE_SPEED),c.moveDown=!1):d.position.y-=f.USER_MOVE_SPEED),c.moveUp&&(e?(j(f.OBJECT_MOVE_SPEED),c.moveUp=!1):d.position.y+=f.USER_MOVE_SPEED),c.moveForward&&(d.position.z-=Math.cos(d.rotation.y)*f.USER_MOVE_SPEED,d.position.x-=Math.sin(d.rotation.y)*f.USER_MOVE_SPEED),c.moveObjectForward&&e&&(o(),c.moveObjectForward=!1),c.moveBack&&(d.position.z+=Math.cos(d.rotation.y)*f.USER_MOVE_SPEED,d.position.x+=Math.sin(d.rotation.y)*f.USER_MOVE_SPEED),c.moveObjectBack&&e&&(o(),c.moveObjectBack=!1),c.strafeLeft&&(d.position.z+=Math.cos(d.rotation.y-Math.PI/2)*f.USER_MOVE_SPEED,d.position.x+=Math.sin(d.rotation.y-Math.PI/2)*f.USER_MOVE_SPEED),c.strafeRight&&(d.position.z-=Math.cos(d.rotation.y-Math.PI/2)*f.USER_MOVE_SPEED,d.position.x-=Math.sin(d.rotation.y-Math.PI/2)*f.USER_MOVE_SPEED),c.moveObjectLeft&&e&&(o(),c.moveObjectLeft=!1),c.moveObjectRight&&e&&(o(),c.moveObjectRight=!1)}}}]),angular.module("ng-clockwork.editEvents",[]).factory("editEvents",function(){return{actions:{moveUp:!1,moveDown:!1,moveForward:!1,moveBack:!1,moveObjectForward:!1,moveObjectBack:!1,turnLeft:!1,turnRight:!1,rollLeft:!1,rollRight:!1,moveObjectLeft:!1,moveObjectRight:!1,strafeLeft:!1,strafeRight:!1,resetObjectRotations:!1,rollXLess:!1,rollXMore:!1,rollYLess:!1,rollYMore:!1,rollZLess:!1,rollZMore:!1,cloneObject:!1,deleteObject:!1,fileSave:!1},keyDown:function(a,b){switch(a.which){case 45:b.cloneObject=!0;break;case 46:b.deleteObject=!0;break;case 12:b.resetObjectRotations=!0;break;case 111:b.rollXLess=!0;break;case 106:b.rollXMore=!0;break;case 36:b.rollYLess=!0;break;case 35:b.rollYMore=!0;break;case 33:b.rollZMore=!0;break;case 34:b.rollZLess=!0;break;case 87:b.moveForward=!0;break;case 38:a.ctrlKey?(a.preventDefault(),b.moveUp=!0):b.moveObjectForward=!0;break;case 83:a.ctrlKey?(a.preventDefault(),b.fileSave=!0):b.moveBack=!0;break;case 40:a.ctrlKey?(a.preventDefault(),b.moveDown=!0):b.moveObjectBack=!0;break;case 65:b.turnLeft=!0;break;case 68:b.turnRight=!0;break;case 81:b.strafeLeft=!0;break;case 37:b.moveObjectLeft=!0;break;case 69:b.strafeRight=!0;break;case 39:b.moveObjectRight=!0;break;case 109:b.moveDown=!0;break;case 107:b.moveUp=!0}},keyUp:function(a,b){switch(a.which){case 45:b.cloneObject=!1;break;case 46:b.deleteObject=!1;break;case 12:b.resetObjectRotations=!1;break;case 111:b.rollXLess=!1;break;case 106:b.rollXMore=!1;break;case 36:b.rollYLess=!1;break;case 35:b.rollYMore=!1;break;case 33:b.rollZMore=!1;break;case 34:b.rollZLess=!1;break;case 87:b.moveForward=!1;break;case 83:b.moveBack=!1;break;case 38:b.moveObjectForward=!1;break;case 40:b.moveObjectBack=!1;break;case 65:b.turnLeft=!1;break;case 68:b.turnRight=!1;break;case 81:b.strafeLeft=!1;break;case 37:b.moveObjectLeft=!1;break;case 69:b.strafeRight=!1;break;case 39:b.moveObjectRight=!1;break;case 109:b.moveDown=!1;break;case 107:b.moveUp=!1}}}}),angular.module("ng-clockwork.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]).filter("reverse",function(){function a(a){var b,c=[];if(a)if(angular.isArray(a))c=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}return function(b){return a(b).slice().reverse()}}),angular.module("ng-clockwork.objectLoader",[]).factory("objectStore",["objectUtils",function(a){return{objectSelect:function(a,b){var c=b.camera,d=b.raycaster,e=b.pickerObjects,f=new THREE.Vector3;f.set(a.clientX/window.innerWidth*2-1,2*-(a.clientY/window.innerHeight)+1,.5),f.unproject(c),d.ray.set(c.position,f.sub(c.position).normalize());var g=d.intersectObjects(e,!0);b.selectedObject=this.select(g,b.selectedObject,b.scene)},update:function(a,b){var c=a.selectedObject,d=a.scene,e=a.pickerObjects,f=(this.constants,this),g=function(){null!==c&&(i(e),d.remove(c))},h=function(){if(null!==c){var a=function(a){a.movements.degX=c.rotation.x*(180/Math.PI),a.movements.degY=c.rotation.y*(180/Math.PI),a.movements.degZ=c.rotation.z*(180/Math.PI),a.movements.posX=c.position.x,a.movements.posY=c.position.y,a.movements.posZ=c.position.z,a.movements.scaX=c.scale.x,a.movements.scaY=c.scale.y,a.movements.scaZ=c.scale.z},d=angular.extend({},c.userData.template);switch(a(d),d.type){case"ThreeMesh":f._loadThreeType(d),b.moveObjectForward=!0,b.moveObjectRight=!0;break;case"Collada":f._loadCollada(d),b.moveObjectForward=!0,b.moveObjectRight=!0}}},i=function(a){if("Group"===c.type)for(var b=c.children,d=0;d<a.length;d++)for(var e=0;e<b.length;e++)a[d]===b[e].children[0]&&a.splice(d,1);else for(var d=0;d<a.length;d++)a[d]===c&&a.splice(d,1)};b.cloneObject&&(h(),b.cloneObject=!1),b.deleteObject&&(g(),b.deleteObject=!1)},_applyMatrix:function(a,b){a.position.set(b.movements.posX,b.movements.posY,b.movements.posZ);var c=b.movements.degX*(Math.PI/180),d=b.movements.degY*(Math.PI/180),e=b.movements.degZ*(Math.PI/180);a.rotation.set(c,d,e),a.scale.set(b.movements.scaX,b.movements.scaY,b.movements.scaZ)},_addSceneObject:function(a,b){a.degrees=new THREE.Vector3(a.userData.template.movements.degX,a.userData.template.movements.degY,a.userData.template.movements.degZ),this.scene.add(a),b&&this.pickerObjects.push(a)},_loadMeshMaterial:function(a,b){var c={};for(var d in a)c[d]=a[d];if(b){var e=new THREE.TextureLoader,f=e.load(b.path);f.wrapS=f.wrapT=THREE.RepeatWrapping,f.repeat.set(b.repeat.width,b.repeat.height),f.magFilter=THREE.LinearMipMapLinearFilter,c.map=f}return"MeshLambertMaterial"===a.type?new THREE.MeshLambertMaterial(c):new THREE.MeshPhongMaterial(c)},_loadPlaneGeometry:function(a){var b=new THREE.Mesh(new THREE.PlaneGeometry(a.geometry.width,a.geometry.height,a.geometry.widthSegments,a.geometry.heightSegments),this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(b,a),b.userData.template=a,this._addSceneObject(b,!0)},_loadBoxGeometry:function(a){var b=new THREE.BoxGeometry(a.geometry.width,a.geometry.height,a.geometry.depth,a.geometry.widthSegments,a.geometry.heightSegments,a.geometry.depthSegments),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadSphereGeometry:function(a){var b=new THREE.SphereGeometry(a.geometry.radius,a.geometry.widthSegments,a.geometry.heightSegments),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadCircleGeometry:function(a){var b=new THREE.Mesh(new THREE.CircleGeometry(a.geometry.radius,a.geometry.segments,a.geometry.thetaStart,a.geometry.thetaLength),this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(b,a),b.userData.template=a,this._addSceneObject(b,!0)},_loadRingGeometry:function(a){var b=new THREE.Mesh(new THREE.RingGeometry(a.geometry.innerRadius,a.geometry.outerRadius,a.geometry.thetaSegments,a.geometry.phiSegments,a.geometry.thetaStart,a.geometry.thetaLength),this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(b,a),b.userData.template=a,this._addSceneObject(b,!0)},_loadCylinderGeometry:function(a){var b=new THREE.Mesh(new THREE.CylinderGeometry(a.geometry.radiusTop,a.geometry.radiusBottom,a.geometry.height,a.geometry.radiusSegments,a.geometry.heightSegments,a.geometry.openEnded,a.geometry.thetaStart,a.geometry.thetaLength),this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(b,a),b.userData.template=a,this._addSceneObject(b,!0)},_loadOctahedronGeometry:function(a){var b=new THREE.OctahedronGeometry(a.geometry.radius,a.geometry.detail),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadDodecahedronGeometry:function(a){var b=new THREE.OctahedronGeometry(a.geometry.radius,a.geometry.detail),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadIcosahedronGeometry:function(a){var b=new THREE.IcosahedronGeometry(a.geometry.radius,a.geometry.detail),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadTetrahedronGeometry:function(a){var b=new THREE.TetrahedronGeometry(a.geometry.radius,a.geometry.detail),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadTextGeometry:function(a){var b=new THREE.TextGeometry(a.text,a.parameters),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));this._applyMatrix(c,a),c.userData.template=a,this._addSceneObject(c,!0)},_loadCollada:function(a){var b,c=this,d=(this.parent,new THREE.ColladaLoader),e={type:"Collada",path:a.path,scale:a.scale,movements:a.movements};d.load(a.path,function(d){b=d.scene,b.userData.template=e,b.scale.x=b.scale.y=b.scale.z=a.scale,c._applyMatrix(b,a),b.updateMatrix();for(var f=0;f<b.children.length;f++)b.children[f].userData.isCollada=!0,b.children[f].material.transparent=!0,b.children[f].material.side=THREE.DoubleSide,b.children[f].userData.id=b.id,c.pickerObjects.push(b.children[f]);c._addSceneObject(b,!1)})},_loadPerspectiveCamera:function(a){var b=new THREE.PerspectiveCamera(a.fov,a.aspect,a.near,a.far);this._applyMatrix(b,a),b.userData.template=a,this.camera=b,this._addSceneObject(b,!1)},_loadAmbientLight:function(a){var b=new THREE.AmbientLight(a.color);b.userData.template=a,this._addSceneObject(b,!1)},_loadDirectionalLight:function(a){var b=new THREE.DirectionalLight(a.color,a.intensity);b.userData.template=a,b.position.set(a.posX,a.posY,a.posZ),this._addSceneObject(b,!1)},_loadSimpleSkybox:function(a){for(var b=new THREE.BoxGeometry(a.geometry.width,a.geometry.height,a.geometry.depth),c=[],d=0;6>d;d++)var e=new THREE.TextureLoader;c.push(new THREE.MeshBasicMaterial({map:e.load(a.images[d]),side:THREE.BackSide}));var f=new THREE.MeshFaceMaterial(c),g=new THREE.Mesh(b,f);g.userData.template=a,this._addSceneObject(g,!1)},_loadShaderSkybox:function(a){var b=new THREE.CubeTextureLoader,c=b.load(a.images),d=THREE.ShaderLib.cube;d.uniforms.tCube.value=c;var e=new THREE.ShaderMaterial({fragmentShader:d.fragmentShader,vertexShader:d.vertexShader,uniforms:d.uniforms,depthWrite:!1,side:THREE.BackSide}),f=new THREE.Mesh(new THREE.BoxGeometry(a.geometry.width,a.geometry.height,a.geometry.depth,a.geometry.widthSegments,a.geometry.heightSegments,a.geometry.depthSegments),e);f.userData.template=a,this._addSceneObject(f,!1)},_loadGround:function(a){var b=new THREE.PlaneBufferGeometry(a.geometry.width,a.geometry.height),c=new THREE.Mesh(b,this._loadMeshMaterial(a.material,a.texture));c.position.y=0,c.rotation.x=-Math.PI/2,c.userData.clockworkType="ClockworkGround",c.userData.template=a,this._addSceneObject(c,!1)},_loadThreeType:function(a){switch(a.geometry.type){case"PlaneGeometry":this._loadPlaneGeometry(a);break;case"BoxGeometry":this._loadBoxGeometry(a);break;case"SphereGeometry":this._loadSphereGeometry(a);break;case"CircleGeometry":this._loadCircleGeometry(a);break;case"CylinderGeometry":this._loadCylinderGeometry(a);break;case"OctahedronGeometry":this._loadOctahedronGeometry(a);break;case"DodecahedronGeometry":this._loadDodecahedronGeometry(a);break;case"IcosahedronGeometry":this._loadIcosahedronGeometry(a);break;case"TetrahedronGeometry":this._loadTetrahedronGeometry(a);break;case"TextGeometry":this._loadTextGeometry(a);break;case"RingGeometry":this._loadRingGeometry(a);break;case"PlaneBufferGeometry":console.log("THREE.PlaneBufferGeometry is not used at this time as it doesn't support textures");break;default:console.log("No handler for: "+a.geometry.type)}},createNewObject:function(a){a.geometry?this._loadThreeType(a):"Collada"===a.type&&this._loadCollada(a)},loadScene:function(a){this.sceneData=a.sceneData,this.scene=a.scene,this.pickerObjects=a.pickerObjects;for(var b=0;b<this.sceneData.length;b++)switch(this.sceneData[b].type){case"ThreeMesh":this._loadThreeType(this.sceneData[b]);break;case"PerspectiveCamera":this._loadPerspectiveCamera(this.sceneData[b]);break;case"AmbientLight":this._loadAmbientLight(this.sceneData[b]);break;case"Collada":this._loadCollada(this.sceneData[b]);break;case"DirectionalLight":this._loadDirectionalLight(this.sceneData[b]);break;case"ShaderSkybox":this._loadShaderSkybox(this.sceneData[b]);break;case"SimpleSkybox":this._loadSimpleSkybox(this.sceneData[b]);break;case"ClockworkGround":this._loadGround(this.sceneData[b]);break;default:console.log("No handler for: "+this.sceneData[b].type)}return this.camera},select:function(a,b,c){if(a.length>0){var d=a[0].object;d.userData.isCollada&&(d=c.getObjectById(d.userData.id,!1)),b!==d?(b&&(this._removeSelectionWrapper(b),b=null),b=d,this._addSelectionWrapper(b)):(this._removeSelectionWrapper(b),b=null)}else b&&this._removeSelectionWrapper(b),b=null;return b},_addSelectionWrapper:function(b){var c=a.getCompoundBoundingBox(b),d=new THREE.BoxGeometry(c.x,c.y,c.z),e=new THREE.MeshBasicMaterial({wireframe:!0}),f=new THREE.Mesh(d,e);f.name="wrap",f.position.set(0,0,0),b.add(f)},_removeSelectionWrapper:function(a){var b=a.getObjectByName("wrap");a.remove(b)},_addSelectionHighlight:function(a){if("Group"===a.type){var b=a.children;$.each(b,function(a,b){b.children[0].userData.emissive=b.children[0].material.emissive,b.children[0].material.emissive=new THREE.Color(4259648)})}else a.userData.emissive=a.material.emissive,a.material.emissive=new THREE.Color(4259648)},_remSelectionHighlight:function(a){if("Group"===a.type){var b=a.children;$.each(b,function(a,b){"undefined"!=typeof b.children[0]&&(b.children[0].material.emissive=b.children[0].userData.emissive)})}else a.material.emissive=a.userData.emissive},_unselectObject:function(a,b){this._removeSelectionWrapper(a),b=null},_selectObject:function(a,b){b&&(this._removeSelectionWrapper(b),b=null),b=a,this._addSelectionWrapper()},_selectClone:function(a){this.parent.ClockworkController._selectObject(a)}}}]),angular.module("ng-clockwork.sceneFactory",[]).factory("threeScene",[function(){return{pickerObjects:[],selectedObject:null,intersects:null,ready:!1,init:function(a){this.viewDimensions={width:a[0].offsetWidth,height:a[0].offsetHeight},this.scene=new THREE.Scene,this.raycaster=new THREE.Raycaster,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(0),this.renderer.setSize(this.viewDimensions.width,this.viewDimensions.height),a.append(this.renderer.domElement)}}}]),angular.module("ng-clockwork.services",[]).factory("dataService",["$http","$httpParamSerializerJQLike","templater",function(a,b,c){return{loadSceneJSON:function(b){var c=a.get(b).then(function(a){return a},function(a){return console.error("Server returned an error or scene data file load: "+a.status),a.status});return c},saveSceneJSON:function(c){var d=b({scene_data:c});a({method:"POST",url:"php/save.php",data:d,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){console.log("Save success! "+a.data+" bytes written to file.")},function(a){console.log("Save failure!"),console.log("Status: "+a.status),console.log("Status text: "+a.statusText),console.log("Data:"),console.log(a.data)})},getAvailableTextures:function(){var b="php/getTextureList.php",c=a.get(b).then(function(a){return a},function(a){return console.error("Server returned an error on texture fetch: "+a.status),a.status});return c},getAvailableModels:function(){var b="php/getModelList.php",c=a.get(b).then(function(a){return a},function(a){return console.error("Server returned an error on texture fetch: "+a.status),a.status});return c},arrayRemoveIndex:function(a,b){for(var c=[],d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c},saveScene:function(a){for(var b=a.scene,d=[],e=b.children,f=0;f<e.length;f++)c.updateTemplateMovements(e[f]),"ShaderSkybox"===e[f].userData.template.type?c.updateShaderSkybox(e[f]):"SimpleSkybox"===e[f].userData.template.type?console.log("SimpleSkybox"):"ClockworkGround"===e[f].userData.template.type?(c.updateMeshGeometry(e[f]),c.updateMeshTemplateMaterial(e[f]),c.updateMeshTemplateTexture(e[f])):("Mesh"===e[f].type&&(c.updateMeshGeometry(e[f]),c.updateMeshTemplateMaterial(e[f]),c.updateMeshTemplateTexture(e[f])),"PerspectiveCamera"===e[f].type&&c.updatePerspectiveCameraTemplate(e[f]),"AmbientLight"===e[f].type&&c.updateAmbientLightTemplate(e[f])),d.push(e[f].userData.template);this.saveSceneJSON(JSON.stringify(d))},jsonStringifyDebug:function(a){var b=[],c=JSON.stringify(a,function(a,c){if("object"==typeof c&&null!==c){if(-1!==b.indexOf(c))return;b.push(c)}return c});return b=null,c}}}]),angular.module("ng-clockwork.templateFactory",[]).factory("templater",function(){return{boxTemplate:{geometry:{width:1,height:1,depth:1,widthSegments:1,
heightSegments:1,depthSegments:1,type:"BoxGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},circleTemplate:{geometry:{radius:1,segments:32,thetaStart:0,thetaLength:2*Math.PI,type:"CircleGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},cylinderTemplate:{geometry:{radiusTop:1,radiusBottom:1,height:1,radiusSegments:16,heightSegments:32,openEnded:!1,thetaStart:0,thetaLength:2*Math.PI,type:"CylinderGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},dodecahedronTemplate:{geometry:{radius:1,detail:0,type:"DodecahedronGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},icosahedronTemplate:{geometry:{radius:1,detail:1,type:"IcosahedronGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},octahedronTemplate:{geometry:{radius:1,detail:0,type:"OctahedronGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},planeTemplate:{geometry:{width:1,height:1,widthSegments:1,heightSegments:1,type:"PlaneGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},ringTemplate:{geometry:{innerRadius:1,outerRadius:2,thetaSegments:32,phiSegments:8,thetaStart:0,thetaLength:2*Math.PI,type:"RingGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},sphereTemplate:{geometry:{radius:1,widthSegments:8,heightSegments:6,phiStart:0,phiLength:2*Math.PI,theteStart:0,thetaLength:2*Math.PI,type:"SphereGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},tetrahedronTemplate:{geometry:{radius:1,detail:0,type:"TetrahedronGeometry"},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},textTemplate:{text:"hello",geometry:{type:"TextGeometry"},parameters:{size:1,height:1,curveSegments:12,font:"titilliumtext22l",weight:"normal",style:"normal",bevelEnabled:!1,bevelThickness:10,bevelSize:8},material:{color:"#ffffff",emissive:"#000000",fog:!0,name:"",opacity:1,flatShading:!0,shininess:1,side:2,specular:"#000000",transparent:!1,type:"MeshPhongMaterial",vertexColors:0,visible:!0},type:"ThreeMesh",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},colladaTemplate:{type:"Collada",path:"./models/camping/na-tent5.dae",movements:{posX:0,posY:0,posZ:0,degX:0,degY:0,degZ:0,scaX:1,scaY:1,scaZ:1}},updateMeshGeometry:function(a){a.userData.template.geometry={},a.userData.template.geometry=a.geometry.parameters,a.userData.template.geometry.type=a.geometry.type},updatePerspectiveCameraTemplate:function(a){a.userData.template.type="PerspectiveCamera",a.userData.template.aspect=a.aspect,a.userData.template.castShadow=a.castShadow,a.userData.template.far=a.far,a.userData.template.fov=a.fov,a.userData.template.frustumCulled=a.frustumCulled,a.userData.template.name=a.name,a.userData.template.near=a.near,a.userData.template.zoom=a.zoom,a.userData.template.visible=a.visible},updateAmbientLightTemplate:function(a){a.userData.template.type="AmbientLight",a.userData.template.castShadow=a.castShadow,a.userData.template.color="#"+a.color.getHexString(),a.userData.template.frustumCulled=a.frustumCulled,a.userData.template.name=a.name,a.userData.template.visible=a.visible},updateMeshTemplateTexture:function(a){a.material.map&&(a.userData.template.texture={anisotropy:a.material.map.anisotropy,path:a.userData.template.texture.path,repeat:{height:a.material.map.repeat.y,width:a.material.map.repeat.x}})},updateMeshTemplateMaterial:function(a){"MeshLambertMaterial"===a.material.type&&(a.userData.template.material={},a.userData.template.material.color="#"+a.material.color.getHexString(),a.userData.template.material.emissive="#"+a.material.emissive.getHexString(),a.userData.template.material.fog=a.material.fog,a.userData.template.material.name=a.material.name,a.userData.template.material.opacity=a.material.opacity,a.userData.template.material.reflectivity=a.material.reflectivity,a.userData.template.material.refractionRatio=a.material.refractionRatio,a.userData.template.material.flatShading=a.material.flatShading,a.userData.template.material.side=a.material.side,a.userData.template.material.transparent=a.material.transparent,a.userData.template.material.type=a.material.type,a.userData.template.material.vertexColors=a.material.vertexColors,a.userData.template.material.visible=a.material.visible),"MeshPhongMaterial"===a.material.type&&(a.userData.template.material={},a.userData.template.material.color="#"+a.material.color.getHexString(),a.userData.template.material.emissive="#"+a.material.emissive.getHexString(),a.userData.template.material.fog=a.material.fog,a.userData.template.material.name=a.material.name,a.userData.template.material.opacity=a.material.opacity,a.userData.template.material.flatShading=a.material.flatShading,a.userData.template.material.shininess=a.material.shininess,a.userData.template.material.side=a.material.side,a.userData.template.material.specular="#"+a.material.specular.getHexString(),a.userData.template.material.transparent=a.material.transparent,a.userData.template.material.type=a.material.type,a.userData.template.material.vertexColors=a.material.vertexColors,a.userData.template.material.visible=a.material.visible)},updateTemplateMovements:function(a){a.userData.template.movements={},a.userData.template.movements={posX:a.position.x,posY:a.position.y,posZ:a.position.z,degX:a.degrees.x,degY:a.degrees.y,degZ:a.degrees.z,scaX:a.scale.x,scaY:a.scale.y,scaZ:a.scale.z}},updateShaderSkybox:function(a){a.userData.template.geometry.width=a.geometry.parameters.width,a.userData.template.geometry.height=a.geometry.parameters.height,a.userData.template.geometry.depth=a.geometry.parameters.depth,a.userData.template.geometry.widthSegments=a.geometry.parameters.widthSegments,a.userData.template.geometry.heightSegments=a.geometry.parameters.heightSegments,a.userData.template.geometry.depthSegments=a.geometry.parameters.depthSegments},updateSimpleSkybox:function(a){},updateClockworkGround:function(a){}}}),angular.module("ng-clockwork.utilFactory",[]).factory("objectUtils",[function(){return{calculateDimensions:function(a){for(var b=0,c=0,d=0,e=0,f=0,g=0,h=0;h<a.children.length;h++)a.children[h].children[0].geometry.computeBoundingBox(),b=Math.min(b,a.children[h].children[0].geometry.boundingBox.min.x),c=Math.max(c,a.children[h].children[0].geometry.boundingBox.max.x),d=Math.min(d,a.children[h].children[0].geometry.boundingBox.min.y),e=Math.max(e,a.children[h].children[0].geometry.boundingBox.max.y),f=Math.min(f,a.children[h].children[0].geometry.boundingBox.min.z),g=Math.max(g,a.children[h].children[0].geometry.boundingBox.max.z);a.depth=(c-b)*a.scale.x,a.height=(e-d)*a.scale.y,a.width=(g-f)*a.scale.z,void 0===a.originalDepth&&(a.originalDepth=a.depth),void 0===a.originalHeight&&(a.originalHeight=a.height),void 0===a.originalWidth&&(a.originalWidth=a.width),console.log("Depth: "+a.depth+", Height: "+a.height+", Width: "+a.width)},getCompoundBoundingBox:function(a){var b=null;a.traverse(function(a){var c=a.geometry;void 0!==c&&(c.computeBoundingBox(),null===b?b=c.boundingBox:b.union(c.boundingBox))});var c={x:b.max.x-b.min.x,y:b.max.y-b.min.y,z:b.max.z-b.min.z,minX:b.min.x,minY:b.min.y,minZ:b.min.z,maxX:b.max.x,maxY:b.max.y,maxZ:b.max.z};return c}}}]).factory("jqSlider",[function(){return{init:function(){$("#slider").slider({value:50,min:0,max:100,slide:function(a,b){$("#slider-value").html(b.value)}})}}}]).factory("degreeSync",[function(){return{getDeg:function(a){return a*(180/Math.PI)},getRad:function(a){return a*(Math.PI/180)},safeChange:function(a,b){return(1e3*a+1e3*b)/1e3},updateRotation:function(a){var b=this.getRad(a.degrees.x),c=this.getRad(a.degrees.y),d=this.getRad(a.degrees.z);a.rotation.set(b,c,d)}}}]).factory("jsUtility",[function(){return{compareGenericAsc:function(a){return function(b,c){var d="*!@_.()#^&%-=+01234567989abcdefghijklmnopqrstuvwxyz",e=d.indexOf(b[a][0]),f=d.indexOf(c[a][0]);return e===f?b[a]<c[a]?-1:b[a]>c[a]?1:0:e-f}},compareGenericDes:function(a){return function(b,c){var d="*!@_.()#^&%-=+01234567989abcdefghijklmnopqrstuvwxyz",e=d.indexOf(b[a][0]),f=d.indexOf(c[a][0]);return e===f?b[a]<c[a]?1:b[a]>c[a]?-1:0:f-e}}}}]);